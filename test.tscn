[gd_scene format=3 uid="uid://bxbp22g2lx7b6"]

[ext_resource type="Script" uid="uid://cepcdh8670vhd" path="res://Systems/ProceduralGen/ProceduralRoomGenerator.cs" id="1_ppyta"]
[ext_resource type="Script" uid="uid://voxy632bro1g" path="res://Systems/ProceduralGen/RoomsDebugVisualizer.cs" id="2_ppyta"]
[ext_resource type="Script" uid="uid://c1lgu0x34m5h2" path="res://Systems/TestScript.cs" id="3_ykrsh"]
[ext_resource type="Resource" uid="uid://rknxtcpf0hkc" path="res://Systems/ProceduralGen/Data/base_procgen.tres" id="4_g14j6"]
[ext_resource type="Resource" uid="uid://c132loxwr5n81" path="res://ruleset.tres" id="5_g14j6"]
[ext_resource type="TileSet" uid="uid://cub01tq8ncrlk" path="res://Entities/World/temp_tileset.tres" id="5_ykrsh"]
[ext_resource type="Script" uid="uid://o87amdw1sspy" path="res://Common/SpriteStacking/StackedSprite.cs" id="7_ehkex"]
[ext_resource type="Texture2D" uid="uid://cskfk2fffn0va" path="res://Entities/door.png" id="8_xersf"]

[sub_resource type="GDScript" id="GDScript_ppyta"]
resource_name = "camera_movement"
script/source = "extends Camera2D

# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	pass # Replace with function body.

var last_pos: Vector2
var current_pos: Vector2

# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(delta: float) -> void:
	current_pos = get_local_mouse_position()
	var delta_pos := last_pos - current_pos
	last_pos = current_pos
	
	if Input.is_mouse_button_pressed(MOUSE_BUTTON_MIDDLE) or (
		Input.is_key_pressed(KEY_ALT) and Input.is_mouse_button_pressed(MOUSE_BUTTON_LEFT)
	):
		position += delta_pos

func _input(event: InputEvent) -> void:
	if event is InputEventMouseButton and event.is_pressed():
		if event.button_index == MOUSE_BUTTON_WHEEL_UP:
			zoom += Vector2.ONE*0.1
		elif event.button_index == MOUSE_BUTTON_WHEEL_DOWN:
			zoom -= Vector2.ONE*0.1
"

[sub_resource type="GDScript" id="GDScript_ykrsh"]
script/source = "extends Label

@onready var camera_2d: Camera2D = $\"../../Camera2D\"


# Called when the node enters the scene tree for the first time.
func _ready() -> void:
	pass # Replace with function body.


# Called every frame. 'delta' is the elapsed time since the previous frame.
func _process(_delta: float) -> void:
	text = \"Zoom: %s\" % camera_2d.zoom
"

[node name="Test" type="Node2D" unique_id=81459051]

[node name="RoomGenerator" type="Node" parent="." unique_id=2095976244]
script = ExtResource("1_ppyta")

[node name="RoomsDebugVisualizer" type="Node2D" parent="." unique_id=89596583 node_paths=PackedStringArray("_generator")]
z_index = 100
script = ExtResource("2_ppyta")
_generator = NodePath("../RoomGenerator")

[node name="Camera2D" type="Camera2D" parent="." unique_id=17372746]
script = SubResource("GDScript_ppyta")

[node name="CanvasLayer" type="CanvasLayer" parent="." unique_id=1893954925]

[node name="Button" type="Button" parent="CanvasLayer" unique_id=43627872 node_paths=PackedStringArray("generator", "tilemap")]
offset_left = 375.0
offset_top = 230.0
offset_right = 472.0
offset_bottom = 261.0
text = "Generate"
script = ExtResource("3_ykrsh")
generator = NodePath("../../RoomGenerator")
settings = ExtResource("4_g14j6")
tilemap = NodePath("../../TileMapLayer")
ruleSet = ExtResource("5_g14j6")

[node name="Label" type="Label" parent="CanvasLayer" unique_id=2103677277]
offset_right = 154.0
offset_bottom = 23.0
text = "Zoom: "
script = SubResource("GDScript_ykrsh")

[node name="TileMapLayer" type="TileMapLayer" parent="." unique_id=1865007474]
texture_filter = 1
tile_set = ExtResource("5_ykrsh")

[node name="Node2D" type="Node2D" parent="." unique_id=1191921790]
position = Vector2(10, -256)

[node name="StackedSprite" type="Node2D" parent="Node2D" unique_id=2034879336 node_paths=PackedStringArray("StackSprites", "_root")]
texture_filter = 1
position = Vector2(14, 0)
script = ExtResource("7_ehkex")
StackTexture = ExtResource("8_xersf")
HFrames = 8
VFrames = 4
Spacing = -1.0
StackSprites = [NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42854"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42855"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42856"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42857"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42858"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42859"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42860"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42861"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42862"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42863"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42864"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42865"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42866"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42867"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42868"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42869"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42870"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42871"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42872"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42873"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42874"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42875"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42876"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42877"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42878"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42879"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42880"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42881"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42882"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42883"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42884"), NodePath("@Node@42852/@Node2D@42853/@Sprite2D@42885")]
_root = NodePath("@Node@42852/@Node2D@42853")
metadata/_custom_type_script = "uid://o87amdw1sspy"
metadata/_edit_group_ = true

[node name="@Node@42852" type="Node" parent="Node2D/StackedSprite" unique_id=713587570]

[node name="@Node2D@42853" type="Node2D" parent="Node2D/StackedSprite/@Node@42852" unique_id=1379161749]
position = Vector2(24, -256)

[node name="@Sprite2D@42854" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1907009419]
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4

[node name="@Sprite2D@42855" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1819798739]
position = Vector2(0, -1)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 1

[node name="@Sprite2D@42856" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=964152470]
position = Vector2(0, -2)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 2

[node name="@Sprite2D@42857" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=584490975]
position = Vector2(0, -3)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 3

[node name="@Sprite2D@42858" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1038640728]
position = Vector2(0, -4)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 4

[node name="@Sprite2D@42859" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1864092170]
position = Vector2(0, -5)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 5

[node name="@Sprite2D@42860" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=63958066]
position = Vector2(0, -6)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 6

[node name="@Sprite2D@42861" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=492653942]
position = Vector2(0, -7)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 7

[node name="@Sprite2D@42862" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1780173566]
position = Vector2(0, -8)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 8

[node name="@Sprite2D@42863" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=573823063]
position = Vector2(0, -9)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 9

[node name="@Sprite2D@42864" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1410296126]
position = Vector2(0, -10)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 10

[node name="@Sprite2D@42865" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1795571871]
position = Vector2(0, -11)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 11

[node name="@Sprite2D@42866" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1790458361]
position = Vector2(0, -12)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 12

[node name="@Sprite2D@42867" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1005260497]
position = Vector2(0, -13)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 13

[node name="@Sprite2D@42868" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=2028732009]
position = Vector2(0, -14)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 14

[node name="@Sprite2D@42869" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1600896199]
position = Vector2(0, -15)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 15

[node name="@Sprite2D@42870" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=235184959]
position = Vector2(0, -16)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 16

[node name="@Sprite2D@42871" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1824901670]
position = Vector2(0, -17)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 17

[node name="@Sprite2D@42872" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1133783702]
position = Vector2(0, -18)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 18

[node name="@Sprite2D@42873" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=348305214]
position = Vector2(0, -19)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 19

[node name="@Sprite2D@42874" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1997829941]
position = Vector2(0, -20)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 20

[node name="@Sprite2D@42875" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=141718949]
position = Vector2(0, -21)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 21

[node name="@Sprite2D@42876" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1927706300]
position = Vector2(0, -22)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 22

[node name="@Sprite2D@42877" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=806420613]
position = Vector2(0, -23)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 23

[node name="@Sprite2D@42878" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1161129691]
position = Vector2(0, -24)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 24

[node name="@Sprite2D@42879" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=767241940]
position = Vector2(0, -25)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 25

[node name="@Sprite2D@42880" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=683641622]
position = Vector2(0, -26)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 26

[node name="@Sprite2D@42881" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1698947136]
position = Vector2(0, -27)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 27

[node name="@Sprite2D@42882" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=585627991]
position = Vector2(0, -28)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 28

[node name="@Sprite2D@42883" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1580713206]
position = Vector2(0, -29)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 29

[node name="@Sprite2D@42884" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=460945171]
position = Vector2(0, -30)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 30

[node name="@Sprite2D@42885" type="Sprite2D" parent="Node2D/StackedSprite/@Node@42852/@Node2D@42853" unique_id=1732548275]
position = Vector2(0, -31)
texture = ExtResource("8_xersf")
hframes = 8
vframes = 4
frame = 31

[connection signal="pressed" from="CanvasLayer/Button" to="CanvasLayer/Button" method="_on_pressed"]
